"use strict";(self["webpackChunkvuedemo"]=self["webpackChunkvuedemo"]||[]).push([[251],{9509:function(e,s,t){t.r(s),t.d(s,{default:function(){return p}});var a=function(){var e=this;e._self._c;return e._m(0)},r=[function(){var e=this,s=e._self._c;return s("div",{staticClass:"tets-permission"},[e._v(" 一个测试权限校验的工具页面 "),s("div")])}],i={name:"TestPermission",data(){return{}},methods:{}},o=i,n=t(1001),l=(0,n.Z)(o,a,r,!1,null,"6ac34314",null),p=l.exports},7884:function(e,s,t){t.r(s),t.d(s,{default:function(){return u}});var a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"update-account"},[s("el-card",{staticClass:"top account"},[s("el-form",{ref:"nameFormIns",attrs:{"label-width":"100px",model:e.profileData,rules:e.profileDataRules}},[s("el-form-item",{attrs:{label:"登录名:",prop:"loginUserName"}},[s("el-input",{model:{value:e.profileData.loginUserName,callback:function(s){e.$set(e.profileData,"loginUserName","string"===typeof s?s.trim():s)},expression:"profileData.loginUserName"}})],1),s("el-form-item",{attrs:{label:"昵称:",prop:"nickName"}},[s("el-input",{model:{value:e.profileData.nickName,callback:function(s){e.$set(e.profileData,"nickName","string"===typeof s?s.trim():s)},expression:"profileData.nickName"}})],1),s("el-form-item",{attrs:{label:""}},[s("el-button",{attrs:{type:"danger"},on:{click:e.triggerUpdateName}},[e._v("确认修改")])],1)],1)],1),s("el-card",{staticClass:"bottom account"},[s("el-form",{ref:"passwordFormIns",attrs:{"label-width":"100px",model:e.passwordData,rules:e.passwordDataRules}},[s("el-form-item",{attrs:{label:"原密码:",prop:"originalPassword"}},[s("el-input",{model:{value:e.passwordData.originalPassword,callback:function(s){e.$set(e.passwordData,"originalPassword","string"===typeof s?s.trim():s)},expression:"passwordData.originalPassword"}})],1),s("el-form-item",{attrs:{label:"新密码:",prop:"newPassword"}},[s("el-input",{model:{value:e.passwordData.newPassword,callback:function(s){e.$set(e.passwordData,"newPassword","string"===typeof s?s.trim():s)},expression:"passwordData.newPassword"}})],1),s("el-form-item",{attrs:{label:""}},[s("el-button",{attrs:{type:"danger"},on:{click:e.triggerUpdatePasswprd}},[e._v("确认修改")])],1)],1)],1)],1)},r=[],i=(t(7658),t(9560)),o=t.n(i),n=t(6280),l=t.n(n),p={name:"update-account",data(){return{profileData:{loginUserName:"",nickName:""},profileDataRules:{loginUserName:[{required:!0,trigger:"blur",message:"登录名不能为空"}],nickName:[{required:!0,trigger:"blur",message:"昵称不能为空"}]},passwordData:{newPassword:"",originalPassword:""},passwordDataRules:{newPassword:[{required:!0,trigger:"blur",message:"新密码不能为空"}],originalPassword:[{required:!0,trigger:"blur",message:"原密码不能为空"}]},permissionHanleType:1}},methods:{async queryData(){try{let e=await this.$api.userProfile(),{resultCode:s,data:t}=e;if(200!==+s)return void this.$message.error("获取用户账户信息错误");this.profileData=t,console.log("profileData==>",this.profileData)}catch(e){console.log("error_in_UpdateAccount.vue:",e)}},async triggerUpdateName(){try{await this.$refs.nameFormIns.validate();let e=this.profileData.loginUserName,s=this.profileData.nickName,{resultCode:t}=await this.$api.adminUsers.updateName({loginUserName:e,nickName:s});if(200!==+t)return void this.$message.error("修改账户名失败");this.$message.success("修改账户名成功")}catch(e){console.log(e)}},async triggerUpdatePasswprd(){try{let e=await this.$refs.passwordFormIns.validate();console.log("测试能否执行到此的输出语句:",e);let s=o()(this.passwordData.originalPassword),t=o()(this.passwordData.newPassword),{resultCode:a}=await this.$api.adminUsers.updatePassword({originalPassword:s,newPassword:t});if(200!==+a)return void this.$message.error("修改密码失败");this.$message.success("修改密码成功")}catch(e){console.log("error",e)}},triggerUpdatePermission(){if(console.log(this.$router.getRoutes()),1===+this.permissionHanleType){let{permitList:e,permitToken:s}=l().storage.get("permission");return e.push("testpermission"),l().storage.set("permission",{permitList:e,permitToken:s}),this.$message("添加测试权限成功，可在右侧系统管理菜单栏查看"),this.permissionHanleType=0,void this.$router.replace("/systemmange/updateaccount").catch((()=>{console.log("")}))}let{permitList:e,permitToken:s}=l().storage.get("permission");e=e.filter((e=>"testpermission"!==e)),l().storage.set("permission",{permitList:e,permitToken:s});let t=l().storage.get("hasAdd");t=t.filter((e=>"testpermission"!==e)),l().storage.set("hasAdd",t),this.$message("移除测试权限成功，右侧系统管理菜单栏看不到了"),this.permissionHanleType=1,this.$router.replace("/systemmange/updateaccount").catch((()=>{console.log("")}))},queryPermission(){let e=this.$store.state.permission;e||(e=this.$store.state.permission=l().storage.get("permission")),console.log("permission-in-accout==>",e),e&&0!==e.permitList.length?this.permissionHanleType=0:this.permissionHanleType=1}},created(){this.queryData(),this.queryPermission()}},m=p,d=t(1001),c=(0,d.Z)(m,a,r,!1,null,"70244598",null),u=c.exports}}]);